<mujoco model="pick_and_place">
    <compiler angle="radian" autolimits="true" />

    <option integrator="Euler" noslip_iterations="3" timestep="0.002" cone="pyramidal">
        <flag multiccd="enable" warmstart="enable" />
    </option>

    <include file="single_side_arm.xml" />

    <statistic center="0.3 0 0.4" extent="1.5" />

    <visual>
        <headlight diffuse="0.6 0.6 0.6" ambient="0.3 0.3 0.3" specular="0 0 0" />
        <rgba haze="0.15 0.25 0.35 1" />
        <global azimuth="120" elevation="-20" />
    </visual>

    <asset>
        <texture type="skybox" builtin="gradient" rgb1="0.3 0.5 0.7" rgb2="0 0 0" width="512"
            height="3072" />
        <texture type="2d" name="groundplane" builtin="checker" mark="edge" rgb1="0.2 0.3 0.4"
            rgb2="0.1 0.2 0.3" markrgb="0.8 0.8 0.8" width="300" height="300" />
        <material name="groundplane" texture="groundplane" texuniform="true" texrepeat="5 5"
            reflectance="0.2" />
    </asset>

    <worldbody>
        <light pos="0 0 1.5" dir="0 0 -1" directional="true" />
        <camera name="watching" pos="1.2 -1.0 1.2" xyaxes="0.644 0.765 0.000 -0.250 0.210 0.945" />
        <camera name="front_view" pos="0.8 0 0.6" xyaxes="0 1 0 0 0 1" />
        <camera name="side_view" pos="0 -1.0 0.6" xyaxes="1 0 0 0 0 1" />

        <geom name="floor" pos="0 0 0" size="0 0 0.05" type="plane" material="groundplane" />

        <!-- Target zone - 根据机械臂结构计算吸盘正下方位置 -->
        <!-- X: trunk(0) + stub偏移(0.185) + stub块(0.06) + link1默认(0.3582) = 0.6032 -->
        <!-- Y: link2默认(0.4714) + rail_frame到slider(0) + slider到spindle(0.04) + spindle到suction(0) =
        0.5114 -->
        <body name="target_zone" pos="0.6032 0.5114 0.025">
            <site name="target" pos="0 0 0" size="0.025 0.025 0.001" rgba="1 0 0 0.8"
                type="cylinder" />
            <!-- Visual indicator for target zone - thin disc on ground -->
            <geom name="target_platform" type="cylinder" size="0.05 0.001" pos="0 0 0"
                rgba="1 0 0 0.5" contype="0" conaffinity="0" />
        </body>

        <!-- Object to pick (sphere on ground, z=0.025 to account for sphere radius) -->
        <body name="obj" pos="0.5 0.2 0.025">
            <joint type="free" damping="0.5" name="obj_joint" />
            <geom name="obj_geom" mass="0.08" type="sphere" size="0.025" rgba="0.2 0.8 0.3 1"
                friction="2.0 0.8 0.01" condim="6" solref="0.01 1.0" solimp="0.95 0.99 0.001" />
            <site name="obj_site" pos="0 0 0" size="0.015" type="sphere" rgba="1 1 0 0.5" />
        </body>

    </worldbody>

    <!-- Additional sensors for pick and place task -->
    <sensor>
        <!-- Object position and orientation -->
        <framepos name="object_pos" objtype="site" objname="obj_site" />
        <framequat name="object_quat" objtype="site" objname="obj_site" />

        <!-- Target position -->
        <framepos name="target_position" objtype="site" objname="target" />

        <!-- Distance between end effector and object -->
        <subtreecom name="object_com" body="obj" />
    </sensor>

    <!-- Equality constraints for suction gripper (activated programmatically) -->
    <equality>
        <weld name="suction_weld" body1="suction_cup" body2="obj" solref="0.02 1"
            solimp="0.9 0.95 0.001" active="false" />
    </equality>

</mujoco>